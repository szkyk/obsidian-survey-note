# Obsidian Survey Note Plugin

Obsidian用のSurveyNoteプラグインです。ノートを構造化されたグリッドレイアウトで整理・編集できます。

## 機能

### 主な機能
- **動的なグリッドレイアウト**:
  - **上段（目的・まとめ）**: フォントサイズ設定に連動した4行分の固定高さを持ち、内容が多ければセクション内でスクロールします。
  - **下段（内容など）**: ウィンドウの高さに応じて柔軟に伸縮し、コンテンツが増えた場合はページ全体がスクロールします。
- **ビューの切り替え**: 通常のMarkdownビューとSurveyNoteビューをコマンドやアイコンから簡単に切り替えられます。
- **リッチなMarkdown編集**: 各セクションは、Minimalテーマ風のスタイルが適用された高機能なMarkdownエディタ（CodeMirror）で編集できます。
- **フォーカス表示**: 編集中のセクションがハイライトされ、どこを編集しているかが一目でわかります。
- **コードブロックのスタイル**: コードブロックが背景色付きで見やすく表示されます。
- **タイトル編集**: SurveyNoteビューのタイトルを直接編集することで、ファイル名を変更できます。
- **画像のドラッグ＆ドロップ**: エディタに画像を直接ドラッグ＆ドロップして埋め込むことができます。
- **自動保存**: 編集内容はリアルタイムで自動的にMarkdownファイルに保存されます。
- **カスタマイズ可能なUI**: 設定画面からエディタのフォントサイズやテーマ（ライト/ダーク/自動）を調整できます。

### 使用方法

1. **ビューを開く**
   - リボンメニュー（左端のサイドバー）にあるSurveyNoteアイコンをクリックします。
   - コマンドパレット（`Ctrl/Cmd + P`）から「SurveyNote表示に切り替え」を実行します。
   - これにより、現在アクティブなMarkdownファイルがSurveyNoteビューで開きます。

2. **編集**
   - SurveyNoteビューでは、各セクションが独立したエディタとして表示されます。
   - Markdown記法が利用でき、スタイルはリアルタイムでプレビューされます。
   - 編集内容は自動で保存されます。

3. **Markdownビューに戻る**
   - SurveyNoteビューのヘッダーにあるファイルアイコン（「Markdown表示に切り替え」）をクリックします。
   - コマンドパレットから「マークダウン表示に切り替え」を実行します。

### データ構造
- このプラグインは、ノートのフロントマターではなく、**Markdown本文**にデータを保存します。
- 各セクションの内容は、以下のようなレベル2ヘッダー��`##`）で区切られます。
  ```markdown
  ## Purpose
  ここに背景や目的を入力します。

  ## Summary
  ここにまとめを入力します。

  ## Content1
  ...
  ```

### レイアウト

SurveyNoteビューでは、以下のようなレイアウトで表示されます：

```
┌─────────────────────────────────────────────────────────────┐
│                      ノートタイトル (編集可能)                  │
├─────────────────────────────────────────────────────────────┤
│  ┌────────────────────────┐ ┌────────────────────────┐     │
│  │         Purpose        │ │         Summary        │     │
│  │                        │ │                        │     │
│  │                        │ │                        │     │
│  └────────────────────────┘ └��───────────────────────┘     │
│  ┌──────────────┐ ┌──────────────┐ ┌──────────────┐     │
│  │    Content1    │ │    Supplement  │ │    Content2    │     │
│  │              │ │              │ │              │     │
│  │              │ │              │ │              │     │
│  │              │ │              │ │              │     │
│  │              │ │              │ │              │     │
│  └──────────────┘ └──────────────┘ └──────────────┘     │
└─────────────────────────────────────────────────────────────┘
```

## インストール

### 手動インストール
1. このリポジトリの最新リリースから`main.js`、`styles.css`、`manifest.json`をダウンロードします。
2. あなたのVault（保管庫）の`.obsidian/plugins/obsidian-survey-note/`ディレクトリ��、ダウンロードしたファイルをコピーします。（ディレクトリがない場合は作成してください）
3. Obsidianの設定画面でプラグインを有効にします。

### 開発環境での使用
1. このリポジトリをクローンします。
2. `npm install`で依存関係をインストールします。
3. `npm run dev`で開発モードを開始します（ファイル変更時に自動でリビルドされます）。
4. Obsidianでプラグインを有効にします。

## 開発

### 必要環境
- Node.js v16以上
- TypeScript

### 開発コマンド
```bash
npm run dev      # 開発モード（ファイル監視）
npm run build    # プロダクションビルド
npm run version  # バージョン番号の更新
```

### 技術仕様
- **TypeScript**: 型安全性とコード品質の向上
- **Obsidian API**: プラグインの標準APIを使用
- **カスタムビュー**: `ItemView`を活用した独自ビューの実装
- **CodeMirror**: 各セクションに高機能なMarkdownエディタを提供

## 今後のマイルストーン
- [x] 下の段の枠は、最低限の高さ以上に文章が行くと表示エリアを広げるように、枠を広げること。現状は枠の中でスクロール担っているが、ページ全体でスクロールされるようにしたい
- [x] ファイル名入力欄以外の入力欄は、フォーカスしたとき、その枠を目立たせるようにする。
- [x] コードブロックを見やすく表示する
- [ ] ドラッグアンドドロップで、SurveyNoteプレビューに挿入した画像を、そのままインラインでプレ��ューできるようにする。
- [ ] コードブロックは、右上にコピーアイコンを設置して、アイコンをクリップしたらコピーできるようにする
- [ ] ブロックリンクや、URLリンクをクリックしたときに、そこに移動できる
- [ ] 画像のインラインで表示させるサイズは変更できる
- [ ] survery viewに切り替えをできるボタンを、ファイルのタイトルバーの近くに置く

## ライセンス

MIT License

## 貢献

バグ報告や機能要求は、GitHubのIssuesでお知らせください。プルリクエストも歓迎します。
